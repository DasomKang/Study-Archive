




![img1|300](Resource/img/causal1.png)



- Notation
	- T : 처치 변수
	- W: 교란 변수
	- Z: 도구 변수

- 수식 
	- $Y_i = \beta_0 + kT_i + v_i$   
	-  $v_i = \beta W_i + u_i$
  

  
- Instrumental Variables (도구 변수)?
	- X에만 영향을 끼치고, Y에는 영향을 끼치지 않음을 이미 알고 있는 변수 
	- 도구 변수를 추가했을 때 Y의 변화를 추적함으로써, X가 정말로 Y에 영향을 미치는지 알 수 있슴
		- Y에 대한 T 효과를 확인할 때, Y에 Z 효과를 Y에 대한 T효과로 바꿔서 확인할 수 있음.
	 - Exclusion Restriction : 도구 변수는 처치를 통한 결과(Y)와만 상관 관계가 있어야 함. Y를 직접 설명하지 않아야 함. 
- 도구 변수가 활용되기 위해서 아래와 같은 유효성 검증을 만족해야 한다.
	- 도구 변수가 T에 영향을 미친다. 
	- 도구 변수 Z가 처치 T를 통해서만 결과 Y에 영향을 준다.
- 도구 변수 추정치를 얻는 또 다른 방법 : 2단계 최소 제곱 회귀분석(2-Stage Least Squares)
	- 2LSL는 이전과 같이 첫 번째 단계의 회귀분석을 수행한 후, 첫 번째 단계의 적합치를 활용해서 처치변수 T를 대신함으로써 회귀 분석을 진행해 실행할 수 있다. 
	- 두 단계에서의 통제변수는 통일시켜야 한다. 
- 특징
	- 도구 변수와 T간 상관관계가 낮으면 ATE의 표준오차가 커지는 것을 유의해야하고, 2SLS자체가 편향성을 가진다는 것을 알아야 한다.
	- 여러개의 도구 변수를 추가할 수도 있다. 




- 수식으로 이해하기 (미안해요 민지님.. 그대로 복붙했어요.. 힘들어서..)


![img1](Resource/img/causal2.png)

![[Study_Archive/Resource/img/causal2.png]]






- 흔히 하는 실수 
	1. 도구변수를 직접 돌려보는 것을 권장하지 않음.
		1. 직접하는 것은 실제 파라미터 측정치가 맞다고 하더라도 잘못된 표준 오차를 발생시킬 가능성이 있음.
		2. IV2SLS 모듈 이용하기.
	2. 첫 번째 단계에서 OLS 방법 이외의 접근법을 사용하지 말 것.
		1. 도구변수의 일관성은 OLS만이 제공해줄 수 있음 (why? OLS의 잔차의 직교성 특성 떄문)
		2. 따라서 첫 번째 단계에서 OLS외 로지 회귀 같은 다른 것을 쓰면 편향된 결과가 도출됨.
		3. OBS 기법(도구변수를 위해 머신러닝을 사용하는 최신 기법)도 있지만 권장하지는 않음.

  
- 요약
	- 다중회귀분석에서 '생략된 변수'가 있으면 편향이 발생하여 제대로 된 모델이 만들어지지 ㅇ낳음.
	- 해결책은 1) 생략된 변수를 모델에 추가 or 2) 도구변수 활용
		- 도구변수를 활용한 분석 : 2SLS 를 사용한 회귀분석 
	- 다만 도구분석이 만병통치약은 아니니 유의
		- 첫 번째 단계가 약하면 (도구변수와 T간 상관관계가 약할 때)
			- 편향 발생 -> 표준오차 커짐 -> 도구변수 추정치 흩뿌려짐
		- 너무 많은 도구변수를 넣으면 
			- 2SLS가 OLS에 가까워짐 -> 생략변수에 대한 일관성을 잃고 -> 편향 발생 



$Y_i = \beta_0 + kT_i + v_i$   
  
$v_i = \beta W_i + u_i$
  
